<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spacecraft Orbit Animation</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
<canvas id="orbitCanvas"></canvas>

<script>
    const canvas = document.getElementById('orbitCanvas');
    const ctx = canvas.getContext('2d');

    // Set canvas size to fill the window
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Constants
    const G = 6.67430e-11; // Gravitational constant (m^3⋅kg^−1⋅s^−2)
    const M = 5.972e24; // Mass of the Earth (kg)
    const EARTH_RADIUS = 6371000; // Earth's radius in meters
    const SCALE = 1e5; // Scale to make the animation visually manageable
    const deltaV1 = 1000; // Impulsive change in velocity (m/s)
    const T1 = 3600; // Time that deltaV1 is applied

    // Initial conditions for the spacecraft (Low Earth Orbit)
    const altitude = 700000; // 700 km altitude for LEO (meters)
    let r = EARTH_RADIUS + altitude; // Initial distance from the center of the Earth (meters)
    
    // Calculate the initial tangential velocity for circular orbit at LEO
    let v = -Math.sqrt(G * M / r); // Orbital velocity in m/s
    
    // Initial angle and position of spacecraft
    let angle = -Math.PI / 2; // Start directly above the Earth (90 degrees)
    let spacecraftX = r * Math.cos(angle);
    let spacecraftY = r * Math.sin(angle);

    // Velocity components
    let vx = -v * Math.sin(angle); // Velocity in the X direction (negative for counter-clockwise motion)
    let vy = v * Math.cos(angle);  // Velocity in the Y direction (positive for upward motion)

    // Time step for the numerical integration
    const dt = 10; // seconds

    // Initialize elapsed simulation time
    let elapsedTime = 0; // Time in seconds

    // Function to convert elapsed time to hours:minutes:seconds
    function formatTime(seconds) {
        let hours = Math.floor(seconds / 3600);
        let minutes = Math.floor((seconds % 3600) / 60);
        let secondsLeft = seconds % 60;

        // Pad single-digit minutes and seconds with leading zero
        return hours.toString().padStart(2, '0') + ':' +
               minutes.toString().padStart(2, '0') + ':' +
               secondsLeft.toFixed(0).padStart(2, '0');
    }

    // Update function for numerical integration
    function updateOrbit() {
        // Apply impulsive velocity change at time T1 seconds (only once)
        if (elapsedTime >= T1 && elapsedTime < T1 + dt) {
            // Calculate the unit vector of the velocity
            let velocityMagnitude = Math.sqrt(vx * vx + vy * vy);
            let unitVectorX = vx / velocityMagnitude;  // Unit vector in x-direction
            let unitVectorY = vy / velocityMagnitude;  // Unit vector in y-direction

            // Apply deltaV1 in the direction of the velocity
            vx += deltaV1 * unitVectorX;  // Add impulsive velocity change in x-direction
            vy += deltaV1 * unitVectorY;  // Add impulsive velocity change in y-direction
        }

        // Calculate gravitational acceleration towards the center
        let acceleration = -G * M / (r * r); // Gravitational acceleration in m/s^2

        // Compute the acceleration components in the X and Y directions
        let ax = acceleration * (spacecraftX / r); // X component of acceleration
        let ay = acceleration * (spacecraftY / r); // Y component of acceleration

        // Update velocity (First-order ODE integration)
        vx += ax * dt;
        vy += ay * dt;

        // Update position based on the new velocity
        spacecraftX += vx * dt;
        spacecraftY += vy * dt;
 
        // Update the distance from the center of the Earth
        r = Math.sqrt(spacecraftX * spacecraftX + spacecraftY * spacecraftY);

        // Update elapsed time
        elapsedTime += dt;

        // Draw the scene
        drawScene();
    }

    // Function to draw the Earth, spacecraft, and elapsed time
    function drawScene() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw the Earth
        ctx.beginPath();
        ctx.arc(canvas.width / 2, canvas.height / 2, EARTH_RADIUS / SCALE, 0, 2 * Math.PI);
        ctx.fillStyle = 'blue';
        ctx.fill();

        // Draw the spacecraft
        ctx.beginPath();
        ctx.arc(canvas.width / 2 + spacecraftX / SCALE, canvas.height / 2 + spacecraftY / SCALE, 10, 0, 2 * Math.PI);
        ctx.fillStyle = 'red';
        ctx.fill();

        // Display the elapsed simulation time (formatted as HH:MM:SS)
        ctx.font = '24px Arial';
        ctx.fillStyle = 'white';
        ctx.fillText('Elapsed Time: ' + formatTime(elapsedTime), 20, 40);
    }

    // Function to animate the system
    function animate() {
        updateOrbit();
        requestAnimationFrame(animate);
    }

    // Start the animation
    animate();
</script>
</body>
</html>
